(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-api-saveAlbum-index"],{"21ec":function(t,i,e){"use strict";e("7a82");var n=e("4ea4").default;Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var r,o=n(e("5cdf")),s={data:function(){return{width:uni.upx2px(500),height:uni.upx2px(500)}},mounted:function(){var t=this;this.$refs.mycanvas.fetch().then((function(i){i.fillCircle(.5*t.width,.5*t.width,.5*t.width),i.draw(),r=i}))},methods:{doit:function(){r.toDataURL().then((function(t){uni.$uniQuery.saveAlbum(t).then((function(){uni.showModal({title:"温馨提示",content:"保存图片到相册成功",showCancel:!1})})).catch((function(t){console.error(t),uni.showModal({title:"温馨提示",content:"保存图片到相册失败",showCancel:!1})}))}))}},components:{VISCanvas:o.default}};i.default=s},"3bd4":function(t,i,e){var n=e("24fb");i=n(!1),i.push([t.i,'.example-title[data-v-624c12c5]{padding:%?20?% 0 %?10?% %?10?%;font-weight:800;font-size:%?30?%}.example-btnInput[data-v-624c12c5]{display:flex;align-items:center}.example-btnInput uni-input[data-v-624c12c5]{flex-grow:1;border-bottom:1px solid grey;margin:0 %?20?%;height:%?50?%;padding:%?4?% %?10?%;font-size:%?26?%}.example-btnInput uni-button[data-v-624c12c5]{flex-shrink:0;margin-right:%?20?%;height:%?50?%;line-height:%?50?%;font-size:12px;display:inline-block;padding:0 %?20?%}.example-btnbottom[data-v-624c12c5]{margin:%?20?% auto;width:-webkit-fit-content;width:fit-content;font-size:12px}.example-ul[data-v-624c12c5]{padding:%?30?%}.example-ul > .example-li[data-v-624c12c5]{margin-top:%?20?%;font-size:12px}.example-ul > .example-li[data-v-624c12c5]::before{content:" # ";font-weight:800;color:#05158e}',""]),t.exports=i},"5cdf":function(t,i,e){"use strict";e.r(i);var n=e("f8ea"),r=e("8f47");for(var o in r)["default"].indexOf(o)<0&&function(t){e.d(i,t,(function(){return r[t]}))}(o);var s=e("f0c5"),a=Object(s["a"])(r["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],void 0);i["default"]=a.exports},"602b":function(t,i,e){"use strict";e.r(i);var n=e("21ec"),r=e.n(n);for(var o in n)["default"].indexOf(o)<0&&function(t){e.d(i,t,(function(){return n[t]}))}(o);i["default"]=r.a},8030:function(t,i,e){"use strict";e.d(i,"b",(function(){return n})),e.d(i,"c",(function(){return r})),e.d(i,"a",(function(){}));var n=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("v-uni-view",{staticClass:"example-container"},[e("VISCanvas",{ref:"mycanvas",attrs:{region:!1,width:t.width,height:t.height}}),e("v-uni-button",{staticClass:"example-btnbottom",attrs:{type:"primary"},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.doit.apply(void 0,arguments)}}},[t._v("保存")])],1)},r=[]},8731:function(t,i,e){"use strict";e.r(i);var n=e("8030"),r=e("602b");for(var o in r)["default"].indexOf(o)<0&&function(t){e.d(i,t,(function(){return r[t]}))}(o);e("90bd");var s=e("f0c5"),a=Object(s["a"])(r["default"],n["b"],n["c"],!1,null,"624c12c5",null,!1,n["a"],void 0);i["default"]=a.exports},"8f47":function(t,i,e){"use strict";e.r(i);var n=e("b283"),r=e.n(n);for(var o in n)["default"].indexOf(o)<0&&function(t){e.d(i,t,(function(){return n[t]}))}(o);i["default"]=r.a},"90bd":function(t,i,e){"use strict";var n=e("9ec2"),r=e.n(n);r.a},"9ec2":function(t,i,e){var n=e("3bd4");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var r=e("4f06").default;r("5c118a1c",n,!0,{sourceMap:!1,shadowMode:!1})},b283:function(t,i,e){"use strict";e("7a82");var n=e("4ea4").default;Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0,e("a9e3"),e("d3b7"),e("ac1f");var r=n(e("f9f9")),o={data:function(){return{uniqueid:(1e4*Math.random()).toFixed(0),help:{},viewImg:"",isH5:!0}},props:{width:{type:Number,default:300},height:{type:Number,default:150},touchstart:{type:Function,default:function(){}},cover:{type:Boolean,default:!0},region:{type:Boolean,default:!0}},methods:{fetch:function(){var t,i,e,n,o=this;t=uni.createCanvasContext("painter-"+this.uniqueid,this),this.region&&(i=uni.createCanvasContext("region-"+this.uniqueid,this)),e="painter-"+this.uniqueid,n="region-"+this.uniqueid;var s=this;return this.help.instance=new r.default({getContext:function(){return t}},s.region?{getContext:function(){return i.getImageData=function(t,i,e,r){return new Promise((function(o,a){var h={x:t,y:i,width:e,height:r,canvasId:n,success:function(t){o(t.data)},fail:function(t){a(t)}};uni.canvasGetImageData(h,s)}))},i}}:null),this.help.instance.draw=function(){var n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};t.draw(n,(function(){o.cover||o.isH5?(s.region&&i.draw(n),r()):uni.canvasToTempFilePath({canvasId:e,success:function(t){o.viewImg=t.tempFilePath,s.region&&i.draw(n),r()}},o)}))},new Promise((function(t,i){o.help.instance.toDataURL=function(){return new Promise((function(t){uni.canvasToTempFilePath({canvasId:e,success:function(i){t(i.tempFilePath)}},o)}))},t(o.help.instance)}))},doit:function(t,i){var e=this,n=function(t,n){e.help.instance.getRegion(t,n).then((function(r){"function"==typeof i&&i(r),e.$emit("dotouchstart",{name:r,x:t,y:n})}))};if(this.cover||this.isH5){var r=t.touches[0].x,o=t.touches[0].y;n(r,o)}else uni.createSelectorQuery().selectViewport().scrollOffset().exec((function(i){uni.createSelectorQuery().in(e).select(".view-"+e.uniqueid).boundingClientRect((function(e){n(t.touches[0].pageX-e.left-i[0].scrollLeft,t.touches[0].pageY-e.top-i[0].scrollTop)})).exec()}))},doitstart:function(t){this.doit(t,this.touchstart)}}};i.default=o},cb29:function(t,i,e){var n=e("23e7"),r=e("81d5"),o=e("44d2");n({target:"Array",proto:!0},{fill:r}),o("fill")},f8ea:function(t,i,e){"use strict";e.d(i,"b",(function(){return n})),e.d(i,"c",(function(){return r})),e.d(i,"a",(function(){}));var n=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("v-uni-view",{class:t.cover||t.isH5?"cover-view":"normal-view",style:{display:"inline-block"}},[t.cover||t.isH5?t._e():e("v-uni-view",{class:"view-img view-"+t.uniqueid,on:{touchstart:function(i){arguments[0]=i=t.$handleEvent(i),t.doitstart.apply(void 0,arguments)}}},[e("v-uni-image",{style:{width:t.width+"px",height:t.height+"px"},attrs:{src:t.viewImg}})],1),e("v-uni-canvas",{staticClass:"painter",style:[{width:t.width+"px",height:t.height+"px"},t.cover||t.isH5?{}:{position:"fixed",left:"50000px"}],attrs:{"canvas-id":"painter-"+t.uniqueid},on:{touchstart:function(i){arguments[0]=i=t.$handleEvent(i),t.doitstart.apply(void 0,arguments)}}}),t.region?e("v-uni-canvas",{staticClass:"region",style:{width:t.width+"px",height:t.height+"px",position:"fixed",left:"50000px"},attrs:{"canvas-id":"region-"+t.uniqueid}}):t._e()],1)},r=[]},f9f9:function(t,i,e){"use strict";e("7a82"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0,e("131a"),e("d9e2"),e("d401"),e("ac1f"),e("00b4"),e("c975"),e("cb29"),e("d3b7");
/*!
* VISLite JavaScript Library v0.7.0-alpha.0
* git+https://github.com/oi-contrib/VISLite.git
*
* Copyright zxl20070701
* Released under the MIT license
* https://zxl20070701.github.io/notebook/home.html
*
* Publish Date:  Fri Dec 29 2023 22:39:54 GMT+0800 (中国标准时间)
*/
var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var e in i)Object.prototype.hasOwnProperty.call(i,e)&&(t[e]=i[e])},n(t,i)};"function"===typeof SuppressedError&&SuppressedError;var r=function(t,i,e,n,r){var o=Math.cos(e),s=Math.sin(e);return[+((n-t)*o-(r-i)*s+t).toFixed(7),+((n-t)*s+(r-i)*o+i).toFixed(7)]};var o=function(t,i,e,n,r){return t.beginPath(),t.translate(e,n),t.rotate(r),t.font=i.fontStyle+" "+i.fontWeight+" "+i.fontSize+"px "+i.fontFamily,t},s=function(t,i,e,n,o,s,a,h){if(o>s){var u=o;o=s,s=u}return a%=2*Math.PI,h>=1.999999*Math.PI||h<=1.999999*-Math.PI?h=2*Math.PI:h%=2*Math.PI,function(t,i,e,n,o,s,a){i<0&&(t+=i,i*=-1);var h,u=[];h=r(0,0,t,o,0),u[0]=h[0],u[1]=h[1],h=r(0,0,i,h[0],h[1]),u[2]=h[0],u[3]=h[1],h=r(0,0,t,s,0),u[4]=h[0],u[5]=h[1],h=r(0,0,i,h[0],h[1]),u[6]=h[0],u[7]=h[1],a(t,t+i,u[0]+e,u[1]+n,u[4]+e,u[5]+n,u[2]+e,u[3]+n,u[6]+e,u[7]+n,.5*(s-o))}(a,h,e,n,o,s,(function(r,a,h,u,l,c,_,f,p,g,d){d<0&&(d=-d),t.beginPath(),t.moveTo(h,u),t.arc(e,n,o,r,a,!1),"round"==i.arcEndCap?t.arc(.5*(_+p),.5*(f+g),d,a-Math.PI,a,!0):"-round"==i.arcEndCap?t.arc(.5*(_+p),.5*(f+g),d,a-Math.PI,a,!1):t.lineTo(p,g),t.arc(e,n,s,a,r,!0),"round"==i.arcStartCap?t.arc(.5*(h+l),.5*(u+c),d,r,r-Math.PI,!0):"-round"==i.arcStartCap?t.arc(.5*(h+l),.5*(u+c),d,r,r-Math.PI,!1):t.lineTo(h,u)})),"butt"==i.arcStartCap&&t.closePath(),t},a=function(t,i,e,n){return t.beginPath(),t.moveTo(i+n,e),t.arc(i,e,n,0,2*Math.PI),t},h=function(t,i,e,n,r){return t.beginPath(),t.rect(i,e,n,r),t};function u(t,i,e,n,r){for(var o=0,s="",a=0;a<i.length;a++)t.measureText(s+i[a]).width>e||/\n$/.test(s)?(o+=1,r(s,(o-.5)*n),s=i[a]):a==i.length-1?(o+=1,r(s+i[a],(o-.5)*n)):s+=i[a];return o*n}var l=function(){function t(t,i,e,n){void 0===i&&(i={}),void 0===n&&(n=!1),this.__region=null,this.__onlyRegion=!1,this.__specialConfig={fontSize:16,fontFamily:"sans-serif",fontWeight:400,fontStyle:"normal",arcStartCap:"butt",arcEndCap:"butt"},this.__initConfig={fillStyle:"black",strokeStyle:"black",lineWidth:1,textAlign:"left",textBaseline:"middle",lineDash:[],shadowBlur:0,shadowColor:"black"},this.painter=t.getContext("2d",i),this.__region=e,this.__isPainter=n,this.painter.textBaseline="middle",this.painter.textAlign="left"}return t.prototype.useConfig=function(t,i){if(this.__region&&["fillStyle","strokeStyle","shadowBlur","shadowColor"].indexOf(t)<0&&this.__region.useConfig(t,i),this.__isPainter&&this.__onlyRegion)return this;if("lineDash"==t)this.painter.setLineDash&&this.painter.setLineDash(i);else if(t in this.__specialConfig)"fontSize"==t&&(i=Math.round(i)),this.__specialConfig[t]=i;else{if(!(t in this.__initConfig))throw new Error("Illegal configuration item of painter : "+t+" !");this.painter[t]=i}return this},t.prototype.fillText=function(t,i,e,n){return void 0===n&&(n=0),this.__region&&this.__region.fillText(t,i,e,n),this.__isPainter&&this.__onlyRegion||(this.painter.save(),o(this.painter,this.__specialConfig,i,e,n).fillText(t,0,0),this.painter.restore()),this},t.prototype.strokeText=function(t,i,e,n){return void 0===n&&(n=0),this.__region&&this.__region.strokeText(t,i,e,n),this.__isPainter&&this.__onlyRegion||(this.painter.save(),o(this.painter,this.__specialConfig,i,e,n).strokeText(t,0,0),this.painter.restore()),this},t.prototype.fullText=function(t,i,e,n){return void 0===n&&(n=0),this.__region&&this.__region.fullText(t,i,e,n),this.__isPainter&&this.__onlyRegion||(this.painter.save(),o(this.painter,this.__specialConfig,i,e,n),this.painter.fillText(t,0,0),this.painter.strokeText(t,0,0),this.painter.restore()),this},t.prototype.fillTexts=function(t,i,e,n,r,s){var a=this;void 0===r&&(r=1.2),void 0===s&&(s=0);var h=0;if(this.__region&&(h=this.__region.fillTexts(t,i,e,n,r)),this.__isPainter&&this.__onlyRegion)return h;this.painter.save(),o(this.painter,this.__specialConfig,i,e,s);var l=u(this.painter,t,n,this.__specialConfig.fontSize*r,(function(t,i){a.painter.fillText(t,0,i)}));return this.painter.restore(),l},t.prototype.strokeTexts=function(t,i,e,n,r,s){var a=this;void 0===r&&(r=1.2),void 0===s&&(s=0);var h=0;if(this.__region&&(h=this.__region.fillTexts(t,i,e,n,r)),this.__isPainter&&this.__onlyRegion)return h;this.painter.save(),o(this.painter,this.__specialConfig,i,e,s);var l=u(this.painter,t,n,this.__specialConfig.fontSize*r,(function(t,i){a.painter.strokeText(t,0,i)}));return this.painter.restore(),l},t.prototype.fullTexts=function(t,i,e,n,r,s){var a=this;void 0===r&&(r=1.2),void 0===s&&(s=0);var h=0;if(this.__region&&(h=this.__region.fillTexts(t,i,e,n,r)),this.__isPainter&&this.__onlyRegion)return h;this.painter.save(),o(this.painter,this.__specialConfig,i,e,s);var l=u(this.painter,t,n,this.__specialConfig.fontSize*r,(function(t,i){a.painter.fillText(t,0,i),a.painter.strokeText(t,0,i)}));return this.painter.restore(),l},t.prototype.beginPath=function(){return this.__region&&this.__region.beginPath(),this.__isPainter&&this.__onlyRegion||this.painter.beginPath(),this},t.prototype.closePath=function(){return this.__region&&this.__region.closePath(),this.__isPainter&&this.__onlyRegion||this.painter.closePath(),this},t.prototype.moveTo=function(t,i){return this.__region&&this.__region.moveTo(t,i),this.__isPainter&&this.__onlyRegion||this.painter.moveTo(Math.round(t)+.5,Math.round(i)+.5),this},t.prototype.lineTo=function(t,i){return this.__region&&this.__region.lineTo(t,i),this.__isPainter&&this.__onlyRegion||this.painter.lineTo(Math.round(t)+.5,Math.round(i)+.5),this},t.prototype.arc=function(t,i,e,n,r){return this.__region&&this.__region.arc(t,i,e,n,r),this.__isPainter&&this.__onlyRegion||this.painter.arc(t,i,e,n,n+r,r<0),this},t.prototype.fill=function(){return this.__region&&this.__region.fill(),this.__isPainter&&this.__onlyRegion||this.painter.fill(),this},t.prototype.stroke=function(){return this.__region&&this.__region.stroke(),this.__isPainter&&this.__onlyRegion||this.painter.stroke(),this},t.prototype.full=function(){return this.__region&&this.__region.full(),this.__isPainter&&this.__onlyRegion||(this.painter.fill(),this.painter.stroke()),this},t.prototype.save=function(){return this.__region&&this.__region.save(),this.__isPainter&&this.__onlyRegion||this.painter.save(),this},t.prototype.restore=function(){return this.__region&&this.__region.restore(),this.__isPainter&&this.__onlyRegion||this.painter.restore(),this},t.prototype.clip=function(){return this.__region&&this.__region.clip(),this.__isPainter&&this.__onlyRegion||this.painter.clip(),this},t.prototype.quadraticCurveTo=function(t,i,e,n){return this.__region&&this.__region.quadraticCurveTo(t,i,e,n),this.__isPainter&&this.__onlyRegion||this.painter.quadraticCurveTo(t,i,e,n),this},t.prototype.bezierCurveTo=function(t,i,e,n,r,o){return this.__region&&this.__region.bezierCurveTo(t,i,e,n,r,o),this.__isPainter&&this.__onlyRegion||this.painter.bezierCurveTo(t,i,e,n,r,o),this},t.prototype.clearRect=function(t,i,e,n){return this.__region&&this.__region.clearRect(t,i,e,n),this.__isPainter&&this.__onlyRegion||this.painter.clearRect(t,i,e,n),this},t.prototype.fillArc=function(t,i,e,n,r,o){return this.__region&&this.__region.fillArc(t,i,e,n,r,o),this.__isPainter&&this.__onlyRegion||s(this.painter,this.__specialConfig,t,i,e,n,r,o).fill(),this},t.prototype.strokeArc=function(t,i,e,n,r,o){return this.__region&&this.__region.strokeArc(t,i,e,n,r,o),this.__isPainter&&this.__onlyRegion||s(this.painter,this.__specialConfig,t,i,e,n,r,o).stroke(),this},t.prototype.fullArc=function(t,i,e,n,r,o){return this.__region&&this.__region.fullArc(t,i,e,n,r,o),this.__isPainter&&this.__onlyRegion||(s(this.painter,this.__specialConfig,t,i,e,n,r,o),this.painter.fill(),this.painter.stroke()),this},t.prototype.fillCircle=function(t,i,e){return this.__region&&this.__region.fillCircle(t,i,e),this.__isPainter&&this.__onlyRegion||a(this.painter,t,i,e).fill(),this},t.prototype.strokeCircle=function(t,i,e){return this.__region&&this.__region.strokeCircle(t,i,e),this.__isPainter&&this.__onlyRegion||a(this.painter,t,i,e).stroke(),this},t.prototype.fullCircle=function(t,i,e){return this.__region&&this.__region.fullCircle(t,i,e),this.__isPainter&&this.__onlyRegion||(a(this.painter,t,i,e),this.painter.fill(),this.painter.stroke()),this},t.prototype.fillRect=function(t,i,e,n){return this.__region&&this.__region.fillRect(t,i,e,n),this.__isPainter&&this.__onlyRegion||h(this.painter,t,i,e,n).fill(),this},t.prototype.strokeRect=function(t,i,e,n){return this.__region&&this.__region.strokeRect(t,i,e,n),this.__isPainter&&this.__onlyRegion||h(this.painter,t,i,e,n).stroke(),this},t.prototype.fullRect=function(t,i,e,n){return this.__region&&this.__region.fullRect(t,i,e,n),this.__isPainter&&this.__onlyRegion||(h(this.painter,t,i,e,n),this.painter.fill(),this.painter.stroke()),this},t.prototype.draw=function(){},t}();var c={"font-size":"fontSize","font-family":"fontFamily","font-weight":"fontWeight","font-style":"fontStyle","arc-start-cap":"arcStartCap","arc-end-cap":"arcEndCap"},_=function(t){function i(i,e,n){void 0===n&&(n={});var r=t.call(this,i,n,e?new l(e,{willReadFrequently:!0}):null,!0)||this;return r.name="Canvas",r.__regionList={},r.__regionAssemble=function(t,i,e,n){for(var r=[],o=0;o<n;o++)r[o]=t;return function(){for(var o=0;o<n;o++){if(r[o]+e<i){r[o]=+(r[o]+e).toFixed(7);break}o<n-1&&(r[o]=t)}return r}}(0,255,10,3),r.setRegion(""),r}return function(t,i){if("function"!==typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function e(){this.constructor=t}n(t,i),t.prototype=null===i?Object.create(i):(e.prototype=i.prototype,new e)}(i,t),i.prototype.config=function(t){for(var i in t){var e=c[i]||i;this.useConfig(e,t[i])}return this},i.prototype.onlyRegion=function(t){return this.__onlyRegion=t,this},i.prototype.setRegion=function(t){if(this.__region)if(t){if(void 0==this.__regionList[t]){var i=this.__regionAssemble();this.__regionList[t]="rgb("+i[0]+","+i[1]+","+i[2]+")"}this.__region.useConfig("fillStyle",this.__regionList[t])&&this.__region.useConfig("strokeStyle",this.__regionList[t])}else this.__region.useConfig("fillStyle","#000000")&&this.__region.useConfig("strokeStyle","#000000");return this},i.prototype.getRegion=function(t,i){var e=this;return new Promise((function(n){var r=e.__region?e.__region.painter.getImageData(t-.5,i-.5,1,1):{data:[0,0,0,0]},o=r.data,s=function(){if(e.__region)for(var t in e.__regionList)if("rgb("+o[0]+","+o[1]+","+o[2]+")"==e.__regionList[t]){n(t);break}n("")};o?s():r.then((function(t){o=t,s()}))}))},i.prototype.textWidth=function(t){this.painter.save(),o(this.painter,this.__specialConfig,0,0,0);var i=this.painter.measureText(t+"").width;return this.painter.restore(),i},i.prototype.getContext=function(t){return void 0===t&&(t=!1),t?this.__region?this.__region.painter:null:this.painter},i.prototype.getInfo=function(){return{width:this.painter.canvas.width,height:this.painter.canvas.height}},i.prototype.createLinearGradient=function(t,i,e,n){return function(t,i,e,n,r){var o=t.createLinearGradient(i,e,n,r),s={value:function(){return o},setColor:function(t,i){return o.addColorStop(t,i),s}};return s}(this.painter,t,i,e,n)},i.prototype.createRadialGradient=function(t,i,e){return function(t,i,e,n){var r=t.createRadialGradient(i,e,0,i,e,n),o={value:function(){return r},setColor:function(t,i){return r.addColorStop(t,i),o}};return o}(this.painter,t,i,e)},i.prototype.getColor=function(t,i){var e=this.painter.getImageData(t-.5,i-.5,1,1).data;return"rgba("+e[0]+","+e[1]+","+e[2]+","+e[3]+")"},i}(l);i.default=_}}]);