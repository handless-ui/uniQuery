import{d as e,r as a,o as t,c as s,w as l,a as o,k as r,x as n,u as c,b as i,C as u,A as h,i as d,E as f,G as p,M as g,H as v,e as m,m as _,p as y,q as x}from"./index-df4b44f3.js";import{U as k}from"./index.dc656315.js";import{i as I,U as M}from"./index.f0d55a05.js";import{_ as P}from"./plugin-vueexport-helper.1b428a4d.js";const b=P(e({name:"UQBehaviorVercode",props:{bgicon:{type:String,required:!0},righticon:{type:String,required:!0}},setup(e,{expose:m}){const _=e;let y={},x=uni.upx2px(590),P=uni.upx2px(222),b=_.righticon,w=a(!1),C=a("-100vh"),j=a(""),R=a(""),S=a(0),T=a(0),U=a(!1),q=a(!0),D=a(x),L=a(P),z=a(),A=a(),B=(e=!1)=>{e&&(y.resolve("校验通过"),w.value=!1,C.value="-100vh")},E=()=>{q.value=!1,setTimeout((()=>{q.value=!0})),S.value=0,U.value=!1,z.value.fetch().then((e=>{A.value.fetch().then((a=>{let t=Q();e.config({fillStyle:"rgba(0,0,0,0.2)",strokeStyle:"#000"}).save(),V(e,t[0],t[1]),e.fill().stroke().restore().draw(!1,(()=>{e.toDataURL().then((e=>{j.value=e}))})),a.save(),V(a,t[0],t[1]),a.clip().drawImage(_.bgicon,0,0,x,P).then((()=>{a.restore().config({strokeStyle:"white"}).stroke().draw(!1,(()=>{a.toDataURL().then((e=>{R.value=e}))})),T.value=t[0]}))}))}))},G=I.throttle((()=>{let e=S.value-T.value;e>-5&&e<5?(U.value=!0,B(!0)):(E(),B(!1))})),H=e=>{S.value=e.detail.x},Q=()=>{let e=Math.random()*x,a=Math.random()*P;return e<70?e=70:e>x-70&&(e=x-70),a<20?a=20:a>P-70&&(a=P-70),[e,a]},V=(e,a,t)=>{e.beginPath().arc(a+5,t+5,5,Math.PI,.5*Math.PI).arc(a+15,t,5,Math.PI,Math.PI).arc(a+25,t+5,5,-.5*Math.PI,.5*Math.PI).arc(a+30,t+15,5,1.5*Math.PI,Math.PI).arc(a+25,t+25,5,0,.5*Math.PI).arc(a+15,t+30,5,0,-Math.PI).arc(a+5,t+25,5,.5*Math.PI,.5*Math.PI).arc(a,t+15,5,.5*Math.PI,-Math.PI).closePath()};return m({open:()=>(w.value=!0,h((()=>{setTimeout((()=>{C.value="0",E()}),50)})),new Promise(((e,a)=>{y={resolve:e,reject:a}})))}),(a,h)=>{const m=d,_=f,y=p,x=g,I=v;return t(),s(k,{show:c(w),onClick:h[1]||(h[1]=e=>c(B)())},{default:l((()=>[o(m,{onClick:h[0]||(h[0]=r((()=>{}),["stop"])),class:"behavior-vercode-container",style:n([{bottom:c(C)}])},{default:l((()=>[o(m,{class:"title"},{default:l((()=>[i(" 安全验证 ")])),_:1}),o(m,{class:"img"},{default:l((()=>[o(_,{class:"icon",src:e.bgicon},null,8,["src"]),o(_,{class:"icon",src:c(j)},null,8,["src"]),o(_,{style:n({left:c(S)-c(T)+"px"}),class:"icon",src:c(R)},null,8,["style","src"]),o(m,{class:"icon no-show"},{default:l((()=>[o(M,{ref_key:"shadowRef",ref:z,width:c(D),height:c(L)},null,8,["width","height"])])),_:1}),o(m,{class:"icon no-show"},{default:l((()=>[o(M,{ref_key:"boxRef",ref:A,width:c(D),height:c(L)},null,8,["width","height"])])),_:1})])),_:1}),c(U)?(t(),s(m,{key:0,class:"ok"},{default:l((()=>[i(" 拼图验证成功 ")])),_:1})):(t(),s(m,{key:1,class:"drag",onTouchend:c(G),onClick:c(G)},{default:l((()=>[o(m,{class:"tips"},{default:l((()=>[o(m,{class:"bg",style:n({width:c(S)+20+"px"})},null,8,["style"]),o(y,{class:"text"},{default:l((()=>[i("拖动滑块拼图验证")])),_:1})])),_:1}),c(q)?(t(),s(I,{key:0,class:"drag-area"},{default:l((()=>[o(x,{direction:"horizontal",onChange:c(H),class:"drag-btn"},{default:l((()=>[o(_,{class:"icon",src:c(b)},null,8,["src"])])),_:1},8,["onChange"])])),_:1})):u("",!0)])),_:1},8,["onTouchend","onClick"]))])),_:1},8,["style"])])),_:1},8,["show"])}}}),[["__scopeId","data-v-8220128e"]]),w=P(e({__name:"index",setup(e){let r=a(),n=()=>{r.value.open().then((e=>{console.log(e)})).catch((e=>{console.error(e)}))};return m((()=>{setTimeout((()=>{n()}),500)})),(e,a)=>{const u=_(y("ui-behavior-vercode"),b),h=x,f=d;return t(),s(f,{class:"example-container"},{default:l((()=>[o(u,{ref_key:"myvercodeRef",ref:r,bgicon:"/static/images/nanjing.jpeg",righticon:"/static/images/toRight.png"},null,512),o(h,{class:"example-btnbottom",type:"primary",onClick:c(n)},{default:l((()=>[i(" 点击我试试 ")])),_:1},8,["onClick"])])),_:1})}}}),[["__scopeId","data-v-5c878bd5"]]);export{w as default};
