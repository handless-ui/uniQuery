import{d as e,r as a,e as t,o as n,c as s,w as o,a as i,n as l,u as r,C as u,b as c,g as d,i as v,q as f,m as h,p as m}from"./index-3f6a7c5d.js";import{U as p}from"./index.0cb25950.js";import{_ as g}from"./plugin-vueexport-helper.1b428a4d.js";const x=g(e({name:"UQSignature",emits:["save","close"],setup(e,{emit:h}){let m,g="ui-signature-"+(1e4*Math.random()).toFixed(0),x=d(),y=a(0),_=a(0),b=a();a();let k=!1,w=a(!1),S=e=>({x:e.y,y:_.value-e.x}),C=e=>{e=S(e),m&&(k=!0,m.beginPath().moveTo(e.x,e.y))},T=e=>{e=S(e),m&&k&&(m.lineTo(e.x,e.y).stroke().draw(!0),m.moveTo(e.x,e.y))},R=e=>{e=S(e),m&&(k=!1,m.lineTo(e.x,e.y).stroke().draw(!0))};function j(){m&&m.clearRect(0,0,y.value,_.value).draw(!0)}function M(){m&&m.toDataURL().then((e=>{h("save",e)}))}function U(){h("close")}return t((()=>{uni.createSelectorQuery().in(x).select("#"+g).boundingClientRect((e=>{y.value=e.width,_.value=e.height,setTimeout((()=>{w.value=!0,b.value.fetch().then((e=>{m=e.config({strokeStyle:"black",lineWidth:2})}))}),200)})).exec()})),(e,a)=>{const t=v,d=f;return n(),s(t,{class:"signature-container"},{default:o((()=>[i(t,{class:l(["signature-canvas-container",r(w)?"initial":""]),id:r(g)},{default:o((()=>[0!=r(y)&&0!=r(_)?(n(),s(p,{key:0,onStart:r(C),onMove:r(T),onEnd:r(R),ref_key:"canvasRef",ref:b,width:r(y),height:r(_)},null,8,["onStart","onMove","onEnd","width","height"])):u("",!0)])),_:1},8,["class","id"]),i(t,{class:"signature-btns-container"},{default:o((()=>[i(d,{class:"btn",onClick:j,plain:!0},{default:o((()=>[c("重写")])),_:1}),i(d,{class:"btn",onClick:M,type:"primary"},{default:o((()=>[c("保存")])),_:1}),i(d,{class:"btn",onClick:U,type:"warn"},{default:o((()=>[c("关闭")])),_:1})])),_:1})])),_:1})}}}),[["__scopeId","data-v-c29c4c0b"]]),y=e({__name:"index",setup(e){let a=e=>{console.log(e)};return(e,t)=>{const o=h(m("ui-signature"),x);return n(),s(o,{onSave:r(a)},null,8,["onSave"])}}});export{y as default};
