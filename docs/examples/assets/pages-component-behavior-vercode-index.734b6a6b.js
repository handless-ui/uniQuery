import{d as e,r as a,o as t,c as o,w as s,a as l,k as r,x as n,u as c,b as i,C as u,A as h,i as d,E as g,G as p,M as v,H as f,e as m,m as T,p as _,q as x}from"./index-7053ad66.js";import{U as y}from"./index.acf895dc.js";import{V as b}from"./ui-canvas.8f8150d9.js";import{_ as k}from"./_plugin-vue_export-helper.1b428a4d.js";const w=k(e({name:"UQBehaviorVercode",props:{bgicon:{type:String,required:!0},righticon:{type:String,required:!0}},setup(e,{expose:m}){const T=e;let _={},x=uni.upx2px(590),k=uni.upx2px(222),w=T.righticon,C=a(!1),j=a("-100vh"),R=a(""),S=a(""),U=a(0),q=a(0),I=a(!1),M=a(!0),P=a(x),A=a(k),D=a(),G=a(),L=(e=!1)=>{e&&(_.resolve("校验通过"),C.value=!1,j.value="-100vh")},V=()=>{M.value=!1,setTimeout((()=>{M.value=!0})),U.value=0,I.value=!1,D.value.fetch().then((e=>{G.value.fetch().then((a=>{let t=e.getContext(),o=a.getContext(),s=E();t.fillStyle="rgba(0,0,0,0.2)",t.strokeStyle="#000",t.save(),H(t,s[0],s[1]),t.fill(),t.stroke(),t.restore(),e.draw(!1,(()=>{e.toDataURL().then((e=>{R.value=e}))})),o.setGlobalAlpha(1),o.save(),H(o,s[0],s[1]),o.clip(),a.drawImage(T.bgicon,0,0,x,k).then((()=>{o.restore(),a.config({strokeStyle:"white"}).stroke(),a.draw(!1,(()=>{a.toDataURL().then((e=>{S.value=e}))})),q.value=s[0]}))}))}))},z=()=>{let e=U.value-q.value;e>-5&&e<5?(I.value=!0,L(!0)):(V(),L(!1))},B=e=>{U.value=e.detail.x},E=()=>{let e=Math.random()*x,a=Math.random()*k;return e<70?e=70:e>x-70&&(e=x-70),a<20?a=20:a>k-70&&(a=k-70),[e,a]},H=(e,a,t)=>{e.beginPath(),e.moveTo(a,t),e.arcTo(a,t-5,a+5,t-5,5),e.lineTo(a+10,t-5),e.arcTo(a+10,t-10,a+15,t-10,5),e.arcTo(a+20,t-10,a+20,t-5,5),e.lineTo(a+25,t-5),e.arcTo(a+30,t-5,a+30,t,5),e.lineTo(a+30,t+5),e.arcTo(a+35,t+5,a+35,t+10,5),e.arcTo(a+35,t+15,a+30,t+15,5),e.lineTo(a+30,t+20),e.arcTo(a+30,t+25,a+25,t+25,5),e.lineTo(a+20,t+25),e.arcTo(a+20,t+20,a+15,t+20,5),e.arcTo(a+10,t+20,a+10,t+25,5),e.lineTo(a+5,t+25),e.arcTo(a,t+25,a,t+20,5),e.lineTo(a,t+15),e.arcTo(a+5,t+15,a+5,t+10,5),e.arcTo(a+5,t+5,a,t+5,5),e.lineTo(a,t),e.closePath()};return m({open:()=>(C.value=!0,h((()=>{setTimeout((()=>{j.value="0",V()}),50)})),new Promise(((e,a)=>{_={resolve:e,reject:a}})))}),(a,h)=>{const m=d,T=g,_=p,x=v,k=f;return t(),o(y,{show:c(C),onClick:h[1]||(h[1]=e=>c(L)())},{default:s((()=>[l(m,{onClick:h[0]||(h[0]=r((()=>{}),["stop"])),class:"behavior-vercode-container",style:n([{bottom:c(j)}])},{default:s((()=>[l(m,{class:"title"},{default:s((()=>[i(" 安全验证 ")])),_:1}),l(m,{class:"img"},{default:s((()=>[l(T,{class:"icon",src:e.bgicon},null,8,["src"]),l(T,{class:"icon",src:c(R)},null,8,["src"]),l(T,{style:n({left:c(U)-c(q)+"px"}),class:"icon",src:c(S)},null,8,["style","src"]),l(m,{class:"icon no-show"},{default:s((()=>[l(b,{ref_key:"shadowRef",ref:D,region:!1,width:c(P),height:c(A)},null,8,["width","height"])])),_:1}),l(m,{class:"icon no-show"},{default:s((()=>[l(b,{ref_key:"boxRef",ref:G,region:!1,width:c(P),height:c(A)},null,8,["width","height"])])),_:1})])),_:1}),c(I)?(t(),o(m,{key:0,class:"ok"},{default:s((()=>[i(" 拼图验证成功 ")])),_:1})):(t(),o(m,{key:1,class:"drag",onTouchend:c(z)},{default:s((()=>[l(m,{class:"tips"},{default:s((()=>[l(m,{class:"bg",style:n({width:c(U)+20+"px"})},null,8,["style"]),l(_,{class:"text"},{default:s((()=>[i("拖动滑块拼图验证")])),_:1})])),_:1}),c(M)?(t(),o(k,{key:0,class:"drag-area"},{default:s((()=>[l(x,{direction:"horizontal",onChange:c(B),class:"drag-btn"},{default:s((()=>[l(T,{class:"icon",src:c(w)},null,8,["src"])])),_:1},8,["onChange"])])),_:1})):u("",!0)])),_:1},8,["onTouchend"]))])),_:1},8,["style"])])),_:1},8,["show"])}}}),[["__scopeId","data-v-ccabee59"]]),C=k(e({__name:"index",setup(e){let r=a(),n=()=>{r.value.open().then((e=>{console.log(e)})).catch((e=>{console.error(e)}))};return m((()=>{setTimeout((()=>{n()}),500)})),(e,a)=>{const u=T(_("ui-behavior-vercode"),w),h=x,g=d;return t(),o(g,{class:"example-container"},{default:s((()=>[l(u,{ref_key:"myvercodeRef",ref:r,bgicon:"/static/images/nanjing.jpeg",righticon:"/static/images/toRight.png"},null,512),l(h,{class:"example-btnbottom",type:"primary",onClick:c(n)},{default:s((()=>[i(" 点击我试试 ")])),_:1},8,["onClick"])])),_:1})}}}),[["__scopeId","data-v-8cb5102d"]]);export{C as default};
