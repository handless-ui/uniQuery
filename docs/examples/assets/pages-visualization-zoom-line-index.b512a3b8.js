import{L as e,N as t,d as n,r as i,e as a,o as l,c as d,w as o,u as h,C as r,g as s,i as g,a as x,m as f,p as u}from"./index-df4b44f3.js";import{i as c,U as y}from"./index.f0d55a05.js";import{_ as I}from"./plugin-vueexport-helper.1b428a4d.js";var v,b,p={exports:{}};
/*!
 * PointIn v0.1.1
 * git+https://github.com/oi-contrib/PointIn.git
 */const m=e(p.exports=(v=function(e,t,n,i){return!(n>0&&e<0)&&(n<0&&e>0||(n>0&&e>0?i<t:n<0&&e<0?i>t:0==n&&0==e?i<t:0==n?!(e<0)&&i<t:n<0||i<t))},(b=function(e,t){this.x=e||0,this.y=t||0}).prototype.setPoint=function(e,t){return this.x=e,this.y=t,this},b.prototype.arc=function(e,t,n,i,a,l){if(n>i){var d=n;n=i,i=d}if(this.circle(e,t,n)||!this.circle(e,t,i))return!1;var o,h;l>=0?(o=a,h=a+l):(h=a,o=a+l),o%=2*Math.PI,h%=2*Math.PI,o<0&&(o+=2*Math.PI),h<0&&(h+=2*Math.PI);var r=Math.sqrt((e-this.x)*(e-this.x)+(t-this.y)*(t-this.y)),s=(this.y-t)/r,g=(this.x-e)/r;return o<h?v(Math.sin(o),Math.cos(o),s,g)&&v(s,g,Math.sin(h),Math.cos(h)):!(v(Math.sin(h),Math.cos(h),s,g)&&v(s,g,Math.sin(o),Math.cos(o)))},b.prototype.circle=function(e,t,n){return!(this.x<e-n||this.x>e+n||this.y<t-n||this.y>t+n)&&(e-this.x)*(e-this.x)+(t-this.y)*(t-this.y)<=n*n},b.prototype.polygon=function(e){e.push(e[0]);for(var t=0,n=0;n<e.length-1;n++){var i=e[n],a=e[n+1];i[0]==a[0]&&i[1]==a[1]||(i[1]-this.y)*(a[1]-this.y)<0&&[i[0]+(a[0]-i[0])*(this.y-i[1])/(a[1]-i[1]),this.y][0]>this.x&&(i[1]<a[1]?t+=1:t-=1)}return 0!=t},b.prototype.rect=function(e,t,n,i){return this.x>=e&&this.x<=e+n&&this.y>=t&&this.y<=t+i},b)),M=I(n({name:"UQSimplePie",props:{data:{type:Array,default:[]},color:{type:String,default:"#e94782"},gradient:{type:Array}},setup(e){const t=e;let n="ui-zoom-line-"+(1e4*Math.random()).toFixed(0),x=s(),f=i(0),u=i(0),I=i(),v=55,b=20,p=55,M=30,w={x:0,y:0,height:26,width:0,bottom:10,beginIndex:Math.round(.3*(t.data.length-1)),endIndex:Math.round(.7*(t.data.length-1))},S=t.data[0].value,T=t.data[0].value;for(let i of t.data)i.value>T&&(T=i.value),i.value<S&&(S=i.value);let P=new m,k=0,_="",R=0,A=0,z=0,C=0,j=null,D={beginIndex:0,endIndex:0},L=e=>{j&&(P.setPoint(e.x,e.y),P.rect(R-3,w.y,6,w.height)?_="beginIndex":P.rect(A-3,w.y,6,w.height)?_="endIndex":P.rect(R,w.y-7,A-R,7)&&(k=e.x,D.beginIndex=w.beginIndex,D.endIndex=w.endIndex))},U=e=>{if(_){let t;t=e.x<=w.x?0:e.x>=w.x+w.width?w.width:e.x-w.x;let n=Math.round(t/z);if(w[_]!=n){if(w[_]=n,w.beginIndex>w.endIndex){let e=w.beginIndex;w.beginIndex=w.endIndex,w.endIndex=e,_="beginIndex"==_?"endIndex":"beginIndex"}j(!0)}}else if(k){let n=Math.round((e.x-k)/z);D.beginIndex+n<0?n=-D.beginIndex:D.endIndex+n>=t.data.length&&(n=t.data.length-D.endIndex-1),w.beginIndex=D.beginIndex+n,w.endIndex=D.endIndex+n,j(!0)}},W=e=>{(_||k)&&(_="",k=0,j(!1))},B="";return a((()=>{uni.createSelectorQuery().in(x).select("#"+n).boundingClientRect((e=>{f.value=e.width,u.value=e.height,w.x=v,w.y=u.value-w.height-w.bottom,w.width=f.value-v-p,z=w.width/(t.data.length-1),C=w.height/(T-S),setTimeout((()=>{I.value.fetch().then((e=>{j=c.throttle((n=>{e.reset(),(e=>new Promise((n=>{if(B)n(B);else{e.config({strokeStyle:"#e8ecf6"}).strokeRect(w.x,w.y,w.width,w.height),e.config({fillStyle:"#ebeff8",lineWidth:2,lineJoin:"round"}).beginPath();for(let n=0;n<t.data.length;n++){let i=t.data[n];e.lineTo(w.x+n*z,w.y+w.height-C*(i.value-S))}e.stroke().lineTo(w.x+w.width,w.y+w.height).lineTo(w.x,w.y+w.height).fill(),e.draw(!1,(()=>{e.toDataURL().then((e=>{B=e,n(B)}))}))}})))(e).then((i=>{R=w.x+w.beginIndex*z,A=w.x+w.endIndex*z,e.drawImage(i,0,0,f.value,u.value).then((()=>{e.config({fillStyle:"rgba(33,150,240,0.2)"}).fillRect(R,w.y,A-R,w.height);let i=A-R;i>20&&e.config({fillStyle:"#dfe5f3"}).fillRect(R,w.y,i,-7).config({fillStyle:"white"}).fillRect(R+.5*i-5,w.y-2,10,-3),e.config({strokeStyle:"#bbc8e3",fillStyle:"white"}).beginPath().moveTo(R,w.y).lineTo(R,w.y+w.height).stroke().beginPath().moveTo(A,w.y).lineTo(A,w.y+w.height).stroke().fullRect(R-3,w.y+5,6,w.height-10).fullRect(A-3,w.y+5,6,w.height-10),n&&e.config({fillStyle:"#aaa",textAlign:"right",fontSize:10}).fillText(t.data[w.beginIndex].name,R-5,w.y+.5*w.height).config({textAlign:"left"}).fillText(t.data[w.endIndex].name,A+5,w.y+.5*w.height);let a=t.data[w.beginIndex].value,l=t.data[w.beginIndex].value;for(let e=w.beginIndex+1;e<=w.endIndex;e++){let n=t.data[e];n.value>l&&(l=n.value),n.value<a&&(a=n.value)}t.gradient&&(a>0&&(a=0),l<0&&(l=0));let d=c.ruler(l,a,5);a=d[0],l=d[d.length-1];let o=u.value-M-w.bottom-w.height,h=e=>o-(e-a)/(l-a)*(o-b),r=e=>v+(f.value-v-p)*(e-w.beginIndex)/(w.endIndex-w.beginIndex);e.config({fillStyle:"#75777f",strokeStyle:"#e0e6f1",textAlign:"right",textBaseline:"middle",fontSize:10,lineWidth:.5});for(let t of d){let n=h(t);e.fillText(t,v-2,n).beginPath().moveTo(v,n).lineTo(f.value-p,n).stroke()}if(e.config({textBaseline:"top"}).fillText(t.data[w.endIndex].name,f.value-p,o+5).config({textAlign:"left"}).fillText(t.data[w.beginIndex].name,v,o+5),t.gradient){let n=h(0),i=(n-b)/(o-b);e.beginPath();for(let a=w.beginIndex;a<=w.endIndex;a++)e.lineTo(r(a),h(t.data[a].value));e.config({fillStyle:e.createLinearGradient(0,b,0,o).setColor(0,t.gradient[0]).setColor(i,t.gradient[1]).setColor(1,t.gradient[0]).value()}).lineTo(f.value-p,n).lineTo(v,n).fill()}e.config({lineWidth:2,strokeStyle:t.color}).beginPath();for(let n=w.beginIndex;n<=w.endIndex;n++)e.lineTo(r(n),h(t.data[n].value));e.stroke(),e.draw()}))}))}),{time:50}),j()}))}),200)})).exec()})),(e,t)=>{const i=g;return l(),d(i,{class:"zoom-line-container",id:h(n)},{default:o((()=>[0!=h(f)&&0!=h(u)?(l(),d(y,{key:0,onStart:h(L),onMove:h(U),onEnd:h(W),ref_key:"canvasRef",ref:I,width:h(f),height:h(u)},null,8,["onStart","onMove","onEnd","width","height"])):r("",!0)])),_:1},8,["id"])}}}),[["__scopeId","data-v-dcf8c659"]]);let w=+new Date(1968,9,3),S=[{name:"1968/9/3",value:Math.round(100*Math.random())}];for(let k=1;k<2e4;k++){var T=new Date(w+=864e5);S.push({name:[T.getFullYear(),T.getMonth()+1,T.getDate()].join("/"),value:Math.round(20*(Math.random()-.5)+S[k-1].value)})}const P=I(n({__name:"index",setup:e=>(e,t)=>{const n=f(u("ui-zoom-line"),M),i=g;return l(),d(i,{class:"example-container"},{default:o((()=>[x(i,{style:{height:"500rpx"}},{default:o((()=>[x(n,{data:h(S)},null,8,["data"])])),_:1}),x(i,{style:{height:"500rpx"}},{default:o((()=>[x(n,{data:h(S),gradient:["rgb(255, 158, 68)","rgb(255, 70, 131)"]},null,8,["data","gradient"])])),_:1})])),_:1})}}),[["__scopeId","data-v-3403e523"]]);export{P as default};
